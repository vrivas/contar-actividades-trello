<html>
    <head>
        <title>
            Análisis de actividad en tableros Trello
        </title>
        <script src="test.json.js"></script>
        <script>
            // variables globales
            var actions=null
            var members=null
            var fin=new Date("2021-04-19T23:55:00.0Z")
            var inicio=new Date("2021-03-23T00:00:00.0Z")

            // Escritura en consola
            function w(texto) {
                document.getElementById("consola").innerHTML+=texto+"\n"
            }
            function wln(texto) {
                w("<br/>")
                w(texto)
            }

            
            function nombreTablero() {
                sp_nombre_tablero.innerHTML=data.name
            }

            function miembros() {
                members=data.members
                members.forEach( e => dv_miembros.innerHTML+="<li>"+e.fullName+"</li>\n")
            }

            function start() {
                nombreTablero()
                miembros()
                var actions=data.actions
            
                wln( "Número de acciones totales: "+actions.length)
                actions=actions.filter( e=>(inicio<=new Date(e.date) && new Date(e.date)<=fin) )
                wln( "Número de acciones filtradas: "+actions.length)
            
                // Tipos de acciones
            
                actionsType=[];
                actions.forEach( e => { if
                    (typeof actionsType[e.type] !== 'undefined' ) {
                        ++actionsType[e.type];
                    } else {
                        actionsType[e.type]=0
                    }
                })
            
                wln( "Tipos de actividdes")
                Object.keys(actionsType).forEach( e => 
                    wln( e +": "+actionsType[e] ))
                
                // Miembros
                members=data.members
                cont=[]
                members.forEach( e => cont[e.fullName]=0)
                actions.forEach( e => cont[e.memberCreator.fullName]++)
                members.forEach( e => wln( (fn=e.fullName)+": "+cont[fn]))
            }
        </script>
        
    </head>
    <body>
        <h1>Análisis de actividad en tableros Trello</h1>
        
        <h2>Tablero: <span id="sp_nombre_tablero"></span></h2>
        
        <h3>Miembros</h3>
        <div id="dv_miembros"></div>


        <div id="dv_consola"></div>
        <script>
            start()
        </script>
    </body>

