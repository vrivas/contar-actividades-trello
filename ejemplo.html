<html>
    <head>
        <title>
            Análisis de actividad en tableros Trello
        </title>
        <script>
            function w(texto) {
                document.getElementById("consola").innerHTML+=texto+"\n"
            }
            function wln(texto) {
                w("<br/>")
                w(texto)
            }
        
            function procesarDatos( data ) {
                // Procesar la info.  
                var fin=new Date("2021-04-19T23:55:00.0Z")
                var inicio=new Date("2021-03-23T00:00:00.0Z")
        
                var actions=data.actions
        
                wln( "Número de acciones totales: "+actions.length)
                actions=actions.filter( e=>(inicio<=new Date(e.date) && new Date(e.date)<=fin) )
                wln( "Número de acciones filtradas: "+actions.length)
        
                // Tipos de acciones
        
                actionsType=[];
                actions.forEach( e => { if
                    (typeof actionsType[e.type] !== 'undefined' ) {
                        ++actionsType[e.type];
                    } else {
                        actionsType[e.type]=0
                    }
                })
        
                wln( "Tipos de actividdes")
                Object.keys(actionsType).forEach( e => 
                    wln( e +": "+actionsType[e] ))
                
                // Miembros
                members=data.members
                cont=[]
                members.forEach( e => cont[e.fullName]=0)
                actions.forEach( e => cont[e.memberCreator.fullName]++)
                members.forEach( e => wln( (fn=e.fullName)+": "+cont[fn]))
            }
        
            function procesarURL() {
                fetch(url).then(response => 
                    response.json().then(data => ({
                        data: data,
                        status: response.status
                    })
                ).then(res => {
                    procesarDatos( res.data )
                }));
            }
        </script>
    </head>
    <body>
        <h1>Análisis de actividad en tableros Trello</h1>
        <div id="datos_entrada">
            <label for="url">URL del tablero: </label>
            <input type="url" value="" title="URL del tablero" placeholder="https://trello.com/b/pVQ1d8Ty" id="formUrl" size="40" autofocus/>
        </div>
        <div id="consola"></div>



        <script>
            // asigno evento pulsar enter
            
            formUrl.onkeyup=( e => {
                if(e.keyCode === 13) alert(12)
            } )
        </script>
</body>
